<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è¦ªå­ã®ä»²è‰¯ã—å ã„</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    :root {
      --purple: #6b4bb6;
      --light-purple: #efe9ff;
      --gold: #c9a24d;
      --card-bg: #ffffff;
    }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(180deg, #5e3ea1, #7a5bd6);
      color: #333;
    }
    header {
      padding: 20px;
      color: #fff;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
    }
    .container {
      padding: 16px;
    }
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    .card h2 {
      margin-top: 0;
      font-size: 18px;
    }
    label {
      display: block;
      font-size: 13px;
      margin-top: 10px;
    }
    input, select {
      width: 100%;
      box-sizing: border-box;
      padding: 10px;
      margin-top: 4px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    .hint {
      font-size: 12px;
      margin-top: 6px;
    }
    .hint a {
      color: var(--purple);
      text-decoration: underline;
    }
    .btn {
      width: 100%;
      padding: 14px;
      margin-top: 20px;
      border-radius: 999px;
      border: none;
      font-size: 16px;
      font-weight: bold;
      background: linear-gradient(90deg, var(--gold), #f0d98a);
      color: #4b2f00;
    }
    .sub-btn {
      margin-top: 10px;
      background: var(--light-purple);
      color: var(--purple);
      border: 1px dashed var(--purple);
    }
    .toggle {
      margin-top: 10px;
      display: flex;
      gap: 10px;
    }
    .toggle button {
      flex: 1;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid var(--purple);
      background: #fff;
      color: var(--purple);
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <header>ğŸ£ è¦ªå­ã®ä»²è‰¯ã—å ã„</header>
  <div class="container">

    <div class="card" id="parentCard">
      <h2>ğŸ” è¦ªã®æƒ…å ±</h2>
      <label>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </label>
      <input id="parentName" />

      <label>ç”Ÿå¹´æœˆæ—¥</label>
      <input id="parentBirth" />

      <label>æ€§åˆ¥</label>
      <select id="parentGender"><option>å¥³æ€§</option><option>ç”·æ€§</option><option>ãã®ä»–</option></select>

      <label>è¡€æ¶²å‹</label>
      <select id="parentBlood"><option>A</option><option>B</option><option>O</option><option>AB</option><option>ä¸æ˜</option></select>

      <label>MBTI</label>
      <input id="parentMBTI" />
      <div class="hint">åˆ†ã‹ã‚‰ãªã„æ–¹ã¯ã“ã¡ã‚‰ ğŸ‘‰ <a href="https://pippichanyo-spec.github.io/mbti/" target="_blank">MBTIè¨ºæ–­</a></div>
    </div>

    <div id="childrenArea"></div>
    <button class="btn sub-btn" onclick="addChild()">â• å­ã©ã‚‚ã‚’è¿½åŠ ã™ã‚‹</button>

    <div class="card">
      <h2>ğŸ” ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼</h2>
      <div class="toggle">
        <button onclick="showPartner(true)">è¿½åŠ ã™ã‚‹</button>
        <button onclick="showPartner(false)">è¿½åŠ ã—ãªã„</button>
      </div>
      <div id="partnerArea" class="hidden">
        <label>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </label>
        <input id="partnerName" />
        <label>ç”Ÿå¹´æœˆæ—¥</label>
        <input id="partnerBirth" />
        <label>æ€§åˆ¥</label>
        <select id="partnerGender"><option>å¥³æ€§</option><option>ç”·æ€§</option><option>ãã®ä»–</option></select>
        <label>è¡€æ¶²å‹</label>
        <select id="partnerBlood"><option>A</option><option>B</option><option>O</option><option>AB</option><option>ä¸æ˜</option></select>
        <label>MBTI</label>
        <input id="partnerMBTI" />
      </div>
    </div>

    <button class="btn" onclick="submitForm()">ğŸ”® é‘‘å®šã‚’ç”³ã—è¾¼ã‚€</button>

  </div>

<script>
  const LIFF_ID = "YOUR_LIFF_ID_HERE";
  let childCount = 0;

  window.onload = async () => {
    await liff.init({ liffId: LIFF_ID });
    addChild();
  };

  function addChild() {
    childCount++;
    const area = document.getElementById('childrenArea');
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <h2>ğŸ¤ å­ã©ã‚‚${childCount}</h2>
      <label>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </label><input class="c-name" />
      <label>ç”Ÿå¹´æœˆæ—¥</label><input class="c-birth" />
      <label>æ€§åˆ¥</label><select class="c-gender"><option>å¥³æ€§</option><option>ç”·æ€§</option><option>ãã®ä»–</option></select>
      <label>è¡€æ¶²å‹</label><select class="c-blood"><option>A</option><option>B</option><option>O</option><option>AB</option><option>ä¸æ˜</option></select>
      <label>MBTI</label><input class="c-mbti" />
    `;
    area.appendChild(div);
  }

  function showPartner(show) {
    document.getElementById('partnerArea').classList.toggle('hidden', !show);
  }

  async function submitForm() {
    let msg = `ã€è¦ªã€‘\nãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼š${parentName.value}\nç”Ÿå¹´æœˆæ—¥ï¼š${parentBirth.value}\næ€§åˆ¥ï¼š${parentGender.value}\nè¡€æ¶²å‹ï¼š${parentBlood.value}\nMBTIï¼š${parentMBTI.value}\n\n`;

    document.querySelectorAll('#childrenArea .card').forEach((c, i) => {
      msg += `ã€å­ã©ã‚‚${i+1}ã€‘\n`;
      msg += `ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼š${c.querySelector('.c-name').value}\n`;
      msg += `ç”Ÿå¹´æœˆæ—¥ï¼š${c.querySelector('.c-birth').value}\n`;
      msg += `æ€§åˆ¥ï¼š${c.querySelector('.c-gender').value}\n`;
      msg += `è¡€æ¶²å‹ï¼š${c.querySelector('.c-blood').value}\n`;
      msg += `MBTIï¼š${c.querySelector('.c-mbti').value}\n\n`;
    });

    if (!document.getElementById('partnerArea').classList.contains('hidden')) {
      msg += `ã€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€‘\nãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼š${partnerName.value}\nç”Ÿå¹´æœˆæ—¥ï¼š${partnerBirth.value}\næ€§åˆ¥ï¼š${partnerGender.value}\nè¡€æ¶²å‹ï¼š${partnerBlood.value}\nMBTIï¼š${partnerMBTI.value}\n\n`;
    }

    msg += 'é‘‘å®šã‚’ç”³ã—è¾¼ã¿ã¾ã—ãŸğŸ£âœ¨';

    await liff.sendMessages([{ type: 'text', text: msg }]);
    liff.closeWindow();
  }
</script>
</body>
</html>
